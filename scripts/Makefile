# Docker é¡¹ç›® Makefile
# ä½¿ç”¨æ–¹æ³•: make <command>

.PHONY: help start stop restart build logs status shell init clean

# é»˜è®¤ç›®æ ‡
help:
	@echo "Docker é¡¹ç›®ç®¡ç†å‘½ä»¤:"
	@echo "  make start    - å¯åŠ¨é¡¹ç›®"
	@echo "  make build    - æ„å»ºå¹¶å¯åŠ¨é¡¹ç›®"
	@echo "  make stop     - åœæ­¢é¡¹ç›®"
	@echo "  make restart  - é‡å¯é¡¹ç›®"
	@echo "  make logs     - æŸ¥çœ‹æ—¥å¿—"
	@echo "  make status   - æŸ¥çœ‹çŠ¶æ€"
	@echo "  make shell    - è¿›å…¥åº”ç”¨å®¹å™¨"
	@echo "  make init     - åˆå§‹åŒ–æ•°æ®åº“"
	@echo "  make clean    - æ¸…ç†å®¹å™¨å’Œé•œåƒ"

# å¯åŠ¨é¡¹ç›®
start:
	@echo "ğŸš€ å¯åŠ¨é¡¹ç›®..."
	docker-compose up -d
	@echo "âœ… é¡¹ç›®å¯åŠ¨å®Œæˆï¼è®¿é—®: http://localhost:5000"

# æ„å»ºå¹¶å¯åŠ¨
build:
	@echo "ğŸ”„ æ„å»ºå¹¶å¯åŠ¨é¡¹ç›®..."
	docker-compose up --build -d
	@echo "âœ… æ„å»ºå®Œæˆï¼è®¿é—®: http://localhost:5000"

# åœæ­¢é¡¹ç›®
stop:
	@echo "ğŸ›‘ åœæ­¢é¡¹ç›®..."
	docker-compose down
	@echo "âœ… é¡¹ç›®å·²åœæ­¢"

# é‡å¯é¡¹ç›®
restart: stop start

# æŸ¥çœ‹æ—¥å¿—
logs:
	@echo "ğŸ“‹ æŸ¥çœ‹æ—¥å¿— (Ctrl+C é€€å‡º)..."
	docker-compose logs -f

# æŸ¥çœ‹çŠ¶æ€
status:
	@echo "ğŸ“Š å®¹å™¨çŠ¶æ€:"
	docker-compose ps

# è¿›å…¥å®¹å™¨
shell:
	@echo "ğŸ’» è¿›å…¥åº”ç”¨å®¹å™¨..."
	docker-compose exec app bash

# åˆå§‹åŒ–æ•°æ®åº“
init:
	@echo "ğŸ—„ï¸ åˆå§‹åŒ–æ•°æ®åº“..."
	docker-compose exec app python docker-init.py
	@echo "âœ… æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ"

# æ¸…ç†
clean:
	@echo "ğŸ§¹ æ¸…ç†å®¹å™¨å’Œé•œåƒ..."
	docker-compose down -v --rmi all
	@echo "âœ… æ¸…ç†å®Œæˆ"