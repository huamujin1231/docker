{% extends "base.html" %}

{% block content %}
<h1>管理后台</h1>
<a href="{{ url_for('admin.add_product') }}" class="btn">添加商品</a>
<a href="{{ url_for('admin.clear_cache') }}" class="btn" onclick="return confirm('确定清理所有缓存?')">清理缓存</a>

<h2>商品管理</h2>
<table>
    <tr>
        <th>ID</th>
        <th>名称</th>
        <th>价格</th>
        <th>库存</th>
        <th>操作</th>
    </tr>
    {% for product in products %}
    <tr>
        <td>{{ product.id }}</td>
        <td>{{ product.name }}</td>
        <td>¥{{ product.price }}</td>
        <td>{{ product.stock }}</td>
        <td>
            <a href="{{ url_for('admin.edit_product', id=product.id) }}">编辑</a>
            <a href="{{ url_for('admin.delete_product', id=product.id) }}" onclick="return confirm('确定删除?')">删除</a>
        </td>
    </tr>
    {% endfor %}
</table>

<h2>订单管理</h2>
<table>
    <tr>
        <th>订单ID</th>
        <th>用户</th>
        <th>总额</th>
        <th>状态</th>
        <th>时间</th>
    </tr>
    {% for order in orders %}
    <tr>
        <td>{{ order.id }}</td>
        <td>{{ order.user.username }}</td>
        <td>¥{{ order.total }}</td>
        <td>{{ order.status }}</td>
        <td>{{ order.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
    </tr>
    {% endfor %}
</table>
{% endblock %}
